(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["tema6"],{"0bc6":function(a,s,t){a.exports=t.p+"img/img18.20faffaa.svg"},"107f":function(a,s,t){a.exports=t.p+"img/img02.d9355467.jpg"},1462:function(a,s,t){a.exports=t.p+"img/img05.dd65a657.svg"},"1f77":function(a,s,t){a.exports=t.p+"img/img19.0ad9de29.png"},2620:function(a,s,t){a.exports=t.p+"img/img11.93b55c80.svg"},3407:function(a,s,t){a.exports=t.p+"img/img07.71218f4d.svg"},"8a78":function(a,s,t){a.exports=t.p+"img/img14.42b3a7ac.jpg"},"8fd7":function(a,s,t){a.exports=t.p+"img/img06.61340a9b.svg"},"92ea":function(a,s,t){"use strict";t.r(s);var e=function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"curso-main-container pb-3"},[e("BannerInterno"),e("div",{staticClass:"container tarjeta tarjeta--blanca p-4 p-md-5 mb-5"},[a._m(0),a._m(1),e("div",{staticClass:"BGM05 p-md-5 p-4 mb-5"},[e("div",{staticClass:"BG03 p-4"},[e("SlyderA",{attrs:{tipo:"b"}},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-6 order-lg-1 order-2"},[e("div",{staticClass:"h5 t-ac"},[a._v("Paso 1 Separación de datos")]),e("p",[a._v("Se deben separar los datos en los datos entrenamiento y las clases de la siguiente manera, el dataframe mensaje corresponde a las instancias y atributos, mientras que las etiquetas a las clases.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v("mensaje = pd."),e("span",{staticClass:"t-ab"},[a._v("DataFrame")]),a._v("(df["),e("span",{staticClass:"t-an"},[a._v("'mensaje'")]),a._v("])")]),e("p",{staticClass:"text-white mb-2"},[a._v("etiquetas = pd."),e("span",{staticClass:"t-ab"},[a._v("DataFrame")]),a._v("(df["),e("span",{staticClass:"t-an"},[a._v("'salida'")]),a._v("])")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("(mensaje."),e("span",{staticClass:"t-ab"},[a._v("head")]),a._v("())")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("(etiquetas."),e("span",{staticClass:"t-ab"},[a._v("head")]),a._v("())")])])])]),e("p",{staticClass:"mb-0"},[a._v("El resultado es un dataframe independiente en el que se dividen los datos de aprendizaje de las clases, como se observa en la imagen.")])]),e("div",{staticClass:"col-lg-6 col-10 order-lg-2 order-1 mb-lg-0 mb-4"},[e("figure",{staticClass:"mb-4"},[e("img",{attrs:{src:t("107f"),alt:"Captura de pantalla en la que se muestra el resultado de un dataframe independiente."}})]),e("p",{staticClass:"mb-0"},[a._v("Separación de los datos")])])]),e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-6 order-lg-1 order-2"},[e("div",{staticClass:"h5 t-ac"},[a._v("Paso 2 Conversión de palabras a vectores")]),e("p",[a._v("Lo que se quiere con este procedimiento es realizar el recuento de los tokens o palabras que se obtienen de los mensajes de correo electrónico, el objetivo es crear una matriz que realice un recuento por cada una de las palabras y las construya como un atributo. Para obtener este resultado debe ejecutar los siguientes comandos.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("from")]),a._v(" sklearn.feature_extraction.text import TfidfVectorizer")]),e("p",{staticClass:"t-aw mb-0"},[a._v("vectorizer = TfidfVectorizer() vector = vectorizer.fit_transform(df['mensaje']) vector.shape")])])])]),e("p",{staticClass:"mb-0"},[a._v("El resultado que se obtiene lo puede observa en la imagen.")])]),e("div",{staticClass:"col-lg-6 col-10 order-lg-2 order-1 mb-lg-0 mb-4"},[e("img",{attrs:{src:t("a8c7"),alt:"Captura de pantalla en la que se muestra la conversión de palabras a vectores."}})])]),e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-6 order-lg-1 order-2"},[e("div",{staticClass:"h5 t-ac"},[a._v("Paso 3 Objetivo encontrado")]),e("p",{staticClass:"mb-0"},[a._v("Ya se ha logrado cuantificar cada una de las palabras del texto de tal manera que estos serán los datos con los que entrenaremos el modelo. Lo que resta es almacenar esta variable a una que servirá para el siguiente paso del entrenamiento, para el ejemplo la denominaremos instancias.")])]),e("div",{staticClass:"col-lg-4 col-8 order-lg-2 order-1 mb-lg-0 mb-4"},[e("img",{attrs:{src:t("fdc8"),alt:"Imagen decorativa"}})])])])],1)]),e("separador"),a._m(2),e("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Se puede decir que se tiene la base para empezar a realizar el entrenamiento de los datos, toda vez que ya se sabe cuáles son los datos de entrada y las clases, y ambas se encuentran en valores numéricos tal como se requiere. En el siguiente recurso se dan a conocer algunas recomendaciones importantes para realizar el entrenamiento:")]),a._m(3),e("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Para realizar el entrenamiento seguir cada uno de los siguientes pasos:")]),a._m(4),e("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Todos estos pasos se ven unificados de la siguiente manera:")]),a._m(5),e("separador"),a._m(6),a._m(7),a._m(8),e("separador"),a._m(9),a._m(10),a._m(11),e("separador"),a._m(12),a._m(13),a._m(14)],1)],1)},i=[function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"titulo-principal color-acento-contenido",attrs:{"data-aos":"flip-up"}},[t("div",{staticClass:"titulo-principal__numero"},[t("span",[a._v("6")])]),t("h1",[a._v("Crear el modelo")])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center align-items-center mb-5"},[e("div",{staticClass:"col-lg-8 order-lg-1 order-2",attrs:{"data-aos":"fade-right"}},[e("p",[a._v("Después de la exploración y el preprocesamiento, se continúa con la construcción del modelo, como se puede ver la variable con la que aprenderá el modelo se basa en texto que ya se ha divido en palabras y que se debe empezar a cuantificar para poder pasar la información para que el modelo lo pueda entender.")]),e("p",{staticClass:"mb-0"},[a._v("Como se ha venido desarrollando todas las unidades se realizará una serie de pasos que permitan en este caso la construcción de un modelo, para conocerlos revise con atención el recurso propuesto:")])]),e("div",{staticClass:"col-lg-4 col-8 order-lg-2 order-1 mb-lg-0 mb-4",attrs:{"data-aos":"fade-left"}},[e("img",{attrs:{src:t("9f5a"),alt:"Imagen decorativa"}})])])},function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_6_1","data-aos":"fade-right"}},[t("h2",[a._v("6.1 Entrenamiento")])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-xl-3 col-md-4 col-sm-6 col-8 col-10 mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"tarjeta--boton color-primario h-100 p-4"},[e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-5 col-6"},[e("img",{attrs:{src:t("1462"),alt:"Imagen decorativa"}})])]),e("div",{staticClass:"h5"},[a._v("Selección de datos")]),e("p",{staticClass:"mb-0"},[a._v("Seleccionar los datos de manera aleatoria. No se deben escoger datos que sean continuos o de manera organizada.")])])]),e("div",{staticClass:"col-xl-3 col-md-4 col-sm-6 col-8 col-10 mb-4",attrs:{"data-aos":"flip-right"}},[e("div",{staticClass:"tarjeta--boton color-primario h-100 p-4"},[e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-5 col-6"},[e("img",{attrs:{src:t("8fd7"),alt:"Imagen decorativa"}})])]),e("div",{staticClass:"h5"},[a._v("Separar los datos")]),e("p",{staticClass:"mb-0"},[a._v("Reserve una muestra que por lo general equivalen al veinte por ciento de los datos, los cuales debe asegurarse que no se utilizaron en el aprendizaje.")])])]),e("div",{staticClass:"col-xl-3 col-md-4 col-sm-6 col-8 col-10 mb-4",attrs:{"data-aos":"flip-left"}},[e("div",{staticClass:"tarjeta--boton color-primario h-100 p-4"},[e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-5 col-6"},[e("img",{attrs:{src:t("3407"),alt:"Imagen decorativa"}})])]),e("div",{staticClass:"h5"},[a._v("Entrenar los datos")]),e("p",{staticClass:"mb-0"},[a._v("Seleccione el ochenta por ciento de los datos para realizar el entrenamiento de los datos.")])])]),e("div",{staticClass:"col-xl-3 col-md-4 col-sm-6 col-8 col-10 mb-4",attrs:{"data-aos":"fade-left"}},[e("div",{staticClass:"tarjeta--boton color-primario h-100 p-4"},[e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-5 col-6"},[e("img",{attrs:{src:t("ef64"),alt:"Imagen decorativa"}})])]),e("div",{staticClass:"h5"},[a._v("Selección de algoritmo")]),e("p",{staticClass:"mb-0"},[a._v("De acuerdo con el requerimiento seleccione el algoritmo o algoritmos de clasificaciones que mejor le vayan dependiendo al tipo de problema a resolver.")])])])])},function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-10 BG05 px-0 py-4"},[t("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[t("div",{staticClass:"col-auto"},[t("div",{staticClass:"BGT09 px-4 py-2"},[t("div",{staticClass:"h5 mb-0"},[a._v("Paso 1")])])])]),t("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Cmo primer paso se procede a realizar a seleccionar los datos de entrenamiento y de prueba, para ellos haga usos de los siguientes comandos.")]),t("div",{staticClass:"row px-4 mb-5"},[t("div",{staticClass:"col-auto"},[t("div",{staticClass:"BG12 p-4"},[t("p",{staticClass:"t-aw mb-0"},[a._v("from sklearn.model_selection import GridSearchCV,train_test_split,StratifiedKFold,cross_val_score,learning_curve")]),t("p",{staticClass:"t-aw mb-0"},[a._v("X_train, X_test, y_train, y_test = train_test_split(instancias, df['salida'], test_size=0.2, random_state=131)")])])])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·X_train:")]),a._v(" corresponde a los datos de entrenamiento.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·X_test:")]),a._v(" Aquí se guardan los datos que son separados para realizar las pruebas.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·y_train:")]),a._v(" etiquetas de salida correspondientes a las instancias de entrenamiento.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·y_test:")]),a._v(" etiquetas de salida que corresponde a las instancias seleccionadas de entrenamiento.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·instancias:")]),a._v(" datos preparados para el entrenamiento.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·df['salida']:")]),a._v(" etiquetas o clases de salida de la clasificación de las instancias.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·test_size:")]),a._v(" valor entre 0 y 1 que indica cual es el porcentaje de datos de prueba que será separados, para nuestro ejemplo serán del 20 por ciento es decir 0.2.")]),t("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("·random_state:")]),a._v(" este parámetro se utiliza para realizar la mezcla de los datos aleatoriamente tal como se recomienda anteriormente, el número corresponde al número de llamados de la función y la mezcla se realiza antes de la división de los datos.")]),t("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[t("div",{staticClass:"col-auto"},[t("div",{staticClass:"BGT09 px-4 py-2"},[t("div",{staticClass:"h5 mb-0"},[a._v("Paso 2")])])])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Lo que sigue es la selección del algoritmo de clasificación, en este caso se utilizará el de "),t("em",[a._v("Naive Bayes")]),a._v(", y Regresión Logística.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Se importan las librerías necesarias para poder implementarlas.")]),t("div",{staticClass:"row px-4 mb-5"},[t("div",{staticClass:"col-auto"},[t("div",{staticClass:"BG12 p-4"},[t("p",{staticClass:"t-aw mb-0"},[a._v("from sklearn.naive_bayes import MultinomialNB")]),t("p",{staticClass:"t-aw mb-0"},[a._v("from sklearn.linear_model import LogisticRegression")])])])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Para utilizar el algoritmo de "),t("em",[a._v("Naive Bayes")]),a._v(", se le asigna la configuración a la variable NB,")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",{staticClass:"BGP12"},[a._v("NB = MultinomialNB(alpha=0.5)")])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Tener en cuenta el siguiente parámetro.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",{staticClass:"BGP12"},[a._v("alpha=")]),a._v(" parámetro de suavizado de Laplace si se omite por defecto asignaría 1, para nuestro caso se establecerá en 0.5")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Para el algoritmo de regresión logística se utilizará esta configuración, que se almacenará en la variable RL.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",{staticClass:"BGP12"},[a._v("RL = LogisticRegression(solver='liblinear', penalty='l1')")])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",[a._v("Solver:")]),a._v(" algoritmo para utilizar en el problema de optimización. El valor predeterminado es 'lbfgs'. Para elegir un solucionador, es posible que se desee considerar los siguientes aspectos:")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("·Para conjuntos de datos pequeños, 'liblinear' es una buena opción, mientras que 'sag' y 'saga' son más rápidos para conjuntos grandes;")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("·Para problemas multiclase, solo 'newton-cg', 'sag', 'saga' y 'lbfgs' manejan la pérdida multinomial;")]),t("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("·'liblinear' se limita a esquemas de uno contra el resto.")]),t("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[t("div",{staticClass:"col-auto"},[t("div",{staticClass:"BGT09 px-4 py-2"},[t("div",{staticClass:"h5 mb-0"},[a._v("Paso 3")])])])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Se utilizan los siguientes comandos para realizar el entrenamiento con el algoritmo de "),t("em",[a._v("Naive Bayes")]),a._v(" usar los siguientes comandos.")]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[t("b",{staticClass:"BGP12"},[a._v("NB.fit(X_train,y_train)")])]),t("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Para realizar el entrenamiento con el algoritmo de Regresión Logística, de igual manera use el mismo comando, pero con su respectiva configuración almacenada en la variable RL")]),t("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[t("b",{staticClass:"BGP12"},[a._v("RL.fit(X_train,y_train)")])])])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-10"},[e("div",{staticClass:"tarjeta color-acento-contenido p-4 mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"row justify-content-center align-items-center"},[e("div",{staticClass:"col-lg-2 col-3"},[e("img",{staticClass:"w-75",attrs:{src:t("fdea"),alt:"Imagen decorativa"}})]),e("div",{staticClass:"col-lg col-9"},[e("p",{staticClass:"text-white mb-2"},[a._v("Importación de las librerías:")]),e("p",{staticClass:"text-white mb-2"},[a._v("from sklearn.naive_bayes import MultinomialNB")]),e("p",{staticClass:"t-aw mb-0"},[a._v("from sklearn.linear_model import LogisticRegression")])])])]),e("div",{staticClass:"tarjeta color-acento-contenido p-4 mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"row justify-content-center align-items-center"},[e("div",{staticClass:"col-lg-2 col-3"},[e("img",{staticClass:"w-75",attrs:{src:t("cdfc"),alt:"Imagen decorativa"}})]),e("div",{staticClass:"col-lg col-9"},[e("p",{staticClass:"text-white mb-2"},[a._v("Configuración de los parámetros de los algoritmos de clasificación:")]),e("p",{staticClass:"text-white mb-2"},[a._v("NB = MultinomialNB(alpha=0.2)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("RL = LogisticRegression(solver='liblinear', penalty='l1')")])])])]),e("div",{staticClass:"tarjeta color-acento-contenido p-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"row justify-content-center align-items-center"},[e("div",{staticClass:"col-lg-2 col-3"},[e("img",{staticClass:"w-75",attrs:{src:t("2620"),alt:"Imagen decorativa"}})]),e("div",{staticClass:"col-lg col-9"},[e("p",{staticClass:"text-white mb-2"},[a._v("Entrenamiento:")]),e("p",{staticClass:"text-white mb-2"},[a._v("NB.fit(X_train,y_train)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("RL.fit(X_train,y_train)")])])])])])])},function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_6_2","data-aos":"fade-right"}},[t("h2",[a._v("6.2 Evaluación")])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-4 col-8 mb-lg-0 mb-4",attrs:{"data-aos":"fade-right"}},[e("img",{attrs:{src:t("c090"),alt:"Imagen decorativa"}})]),e("div",{staticClass:"col-lg-8",attrs:{"data-aos":"fade-left"}},[e("p",[a._v("En esta etapa del proceso se debe realizar la evaluación de los modelos. Una vez entrenados se debe probar qué tan eficientes han sido dichos modelos, es importante recordar que en principio se separó un conjunto de datos correspondientes al veinte por ciento, y son estos los que ayudarán a probar el modelo y ver qué tan eficiente es.")]),e("p",{staticClass:"mb-0"},[a._v("Para el proceso de evaluación se debe seguir algunos pasos para conocerlos, revise con atención el siguiente recurso educativo:")])])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-10 BG05 px-0 py-4"},[e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 1")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Se deben importar las librerías necesarias para realizar las métricas.")]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[e("b",{staticClass:"BGP12"},[a._v("from sklearn import metrics")])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 2")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Realizar la predicción de los datos con el modelo entrenado, primero con "),e("em",[a._v("Naive Bayes")]),a._v(" y posteriormente con regresión logística, recordemos que los modelos son NB y RL respectivamente; para realizar la predicción, utilice los datos de prueba y ejecute el siguiente comando.")]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[e("b",{staticClass:"BGP12"},[a._v("y_pred_NB = NB.predict(X_test)")])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Los resultados se almacenan en y_pred_NB, y para el modelo de regresión logística realice el mismo procedimiento, pero almacenando en una variable diferente.")]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[e("b",{staticClass:"BGP12"},[a._v("y_pred_RL = RL.predict(X_test)")])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 3")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Las salidas de la predicción del modelo entrenado se deben comparar con las salidas correctas para ese conjunto de datos, y de esta manera saber el porcentaje de aciertos para cada uno de los modelos. La comparativa se realiza implementando las siguientes líneas de código.")]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Para el modelo de "),e("em",[a._v("Naive Bayes")]),a._v(", utilice el siguiente comando:")]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[e("b",{staticClass:"BGP12"},[a._v("metrics.accuracy_score(y_test, y_pred_NB)")])]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Y el resultado que se obtiene se aprecia en la siguiente imagen.")]),e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-8 px-lg-0 px-4"},[e("figure",{attrs:{"data-aos":"zoom-in"}},[e("img",{attrs:{src:t("aaf7"),alt:"Porcentaje de aciertos para el modelo utilizando Naive Bayes"}})])])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 4")])])])]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("De igual manera se debe comparar en el modelo de regresión logística, cuál es resultado obtenido, ejecutando el mismo comando así:")]),e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-8 px-lg-0 px-4"},[e("figure",{attrs:{"data-aos":"zoom-in"}},[e("img",{attrs:{src:t("8a78"),alt:"Captura de pantalla en el que muestra el mdelo de regresión logística."}})])])]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Como se indicó en las recomendaciones, se dejaron los datos para las pruebas y efectivamente sirvieron para validar la efectividad del modelo, el resultado arrojado es del 98 % donde se utilizó el algoritmo de clasificación "),e("em",[a._v("Naive Bayes")]),a._v(", mientras que con el modelo donde se implementó regresión logística se obtuvo un porcentaje de acierto del 95 %.")])])])},function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_6_3","data-aos":"fade-right"}},[t("h2",[a._v("6.3 Predicciones")])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center align-items-center mb-5"},[e("div",{staticClass:"col-lg-9 order-lg-1 order-2",attrs:{"data-aos":"fade-right"}},[e("p",[a._v("Con los modelos evaluados se procede a realizar las predicciones, esta vez con entradas completamente nuevas. Con el aprendizaje realizado el modelo debería estar en la capacidad de clasificar los datos en correos electrónicos normales o maliciosos.")]),e("p",[a._v("Es importante aclarar que los nuevos datos que le pasen al modelo deben estar relacionados con la temática bajo la cual este modelo fue entrenado, ósea con mensajes de correos electrónicos.")]),e("p",[a._v("Para realizar las predicciones se tomará el modelo con mayor efectividad que arrojó la evaluación, que sería el que se entrenó con el algoritmo de clasificación "),e("em",[a._v("Naive")]),a._v(" Bayes con un porcentaje del 98 por ciento.")]),e("p",{staticClass:"mb-0"},[a._v("Se establecerán múltiples entradas y para este fin se deben seguir los pasos expuestos en el recurso educativo:")])]),e("div",{staticClass:"col-lg-3 col-6 order-lg-2 order-1 mb-lg-0 mb-4",attrs:{"data-aos":"fade-left"}},[e("img",{attrs:{src:t("becd"),alt:"Imagen decorativa"}})])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-10 BG05 px-0 py-4"},[e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 1")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Definir las entradas.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v(" Entrada1=['free mobile now']")]),e("p",{staticClass:"t-aw mb-0"},[a._v(" Entrada2=['Sorry Mr James']")]),e("p",{staticClass:"t-aw mb-0"},[a._v(" Entrada3=['I need your help']")]),e("p",{staticClass:"t-aw mb-0"},[a._v(" Entrada4=['call me text']")])])])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 2")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Crear una función para realizar las predicciones, de la siguiente manera")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v(" def clasificar(resultado):")]),e("p",{staticClass:"t-aw mb-0"},[a._v("     if resultado == 1:")]),e("p",{staticClass:"t-aw mb-0"},[a._v('         print ("Este es un Mensaje Malicioso")')]),e("p",{staticClass:"t-aw mb-0"},[a._v('     else: print ("Es un Mensaje Normal")')])])])]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("La función espera por un resultado en caso de ser 1 lo clasifica como mensaje malicioso de lo contrario como mensaje normal.")]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 3")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Vectorizar las entradas nuevas, así:")]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[e("b",{staticClass:"BGP12"},[a._v("salida=vectorizer.transform(Entrada1)")])]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Se deben transformar los datos y dejarlos de igual manera de cómo se entrenaron.")]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 4")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Predecir y mostrar el resultado Realizar la predicción con la salida de los datos vectorizados y evaluar el resultado con la función de clasificación. resultado = NB.predict(salida) "),e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("('Mensaje: ',Entrada1) clasificar(resultado) El resultado para la primera entrada se aprecia en la imagen.")]),e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-8 px-lg-0 px-4"},[e("figure",{attrs:{"data-aos":"zoom-in"}},[e("img",{attrs:{src:t("ac67"),alt:"Captura de pantalla en la que se evidencia la predicción de entradas."}})])])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 5")])])])]),e("div",{staticClass:"h5 mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Predecir más entradas.")]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Realizar más pruebas para verificar la efectividad del modelo, las demás entradas de nuestro ejemplo dan como resultado la información de la imagen.")]),e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-8 px-lg-0 px-4"},[e("figure",{attrs:{"data-aos":"zoom-in"}},[e("img",{attrs:{src:t("9970"),alt:"Captura de pantalla en la que se evidencia la predicción de entradas."}})])])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 6")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Finalmente, el código completo del proceso de predicción es el siguiente.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v("Entrada1=['free mobile now']")]),e("p",{staticClass:"t-aw mb-0"},[a._v("Entrada2=['Sorry Mr James']")]),e("p",{staticClass:"t-aw mb-0"},[a._v("Entrada3=['I need your help']")]),e("p",{staticClass:"text-white mb-2"},[a._v("Entrada4=['call me text']")]),e("p",{staticClass:"t-aw mb-0"},[a._v("def clasificar(resultado):")]),e("p",{staticClass:"t-aw mb-0"},[a._v("    if resultado == 1:")]),e("p",{staticClass:"t-aw mb-0"},[a._v('        print ("Este es un Mensaje Malicioso")')]),e("p",{staticClass:"t-aw mb-0"},[a._v("    else:")]),e("p",{staticClass:"text-white mb-2"},[a._v('        print ("Es un Mensaje Normal")')]),e("p",{staticClass:"t-aw mb-0"},[a._v("salida=vectorizer.transform(Entrada1)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("resultado = NB.predict(salida)")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("('Mensaje 1: ',Entrada1)")]),e("p",{staticClass:"text-white mb-2"},[a._v("clasificar(resultado)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("salida=vectorizer.transform(Entrada2)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("resultado = NB.predict(salida)")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("('Mensaje 2: ',Entrada2)")]),e("p",{staticClass:"text-white mb-2"},[a._v("clasificar(resultado)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("salida=vectorizer.transform(Entrada3)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("resultado = NB.predict(salida)")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("('Mensaje 3: ',Entrada3)")]),e("p",{staticClass:"text-white mb-2"},[a._v("clasificar(resultado)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("salida=vectorizer.transform(Entrada4)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("resultado = NB.predict(salida)")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("print")]),a._v("('Mensaje 4: ',Entrada4)")])])])])])])},function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_6_4","data-aos":"fade-right"}},[t("h2",[a._v("6.4 Evaluar el modelo y análisis de errores")])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-2 col-4 mb-lg-0 mb-4",attrs:{"data-aos":"fade-right"}},[e("img",{attrs:{src:t("0bc6"),alt:"Imagen decorativa"}})]),e("div",{staticClass:"col-lg-10",attrs:{"data-aos":"fade-left"}},[e("p",[a._v("Finalmente, para analizar el modelo en cuanto al número de errores que se pueden presentar, ya sea porque se realiza la clasificación de correos electrónicos maliciosos como normales, o viceversa, se utilizará la técnica denominada matriz de confusión.")]),e("p",{staticClass:"mb-0"},[a._v("Para implementar dicha técnica se deben seguir los pasos expuestos en el recurso propuesto:")])])])},function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("div",{staticClass:"row justify-content-center mb-4"},[e("div",{staticClass:"col-lg-10 BG05 px-0 py-4"},[e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 1. Importar las librerías")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Para realizar la implementación usaremos la librería que nos ayuda con el proceso, que es la primera, y la segunda librería que nos permitirá las visualizaciones gráficas.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v("from sklearn.metrics import confusion_matrix")]),e("p",{staticClass:"t-aw mb-0"},[e("span",{staticClass:"t-ac"},[a._v("import")]),a._v(" seaborn "),e("span",{staticClass:"t-ac"},[a._v("as")]),a._v(" sns")])])])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 2. Realizar la predicción con las pruebas")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Procedemos nuevamente a realizar las predicciones con nuestro conjunto de datos de prueba, ya que son los indicados para generar un análisis que permita determinar qué tantos errores se presentan en nuestro modelo.")]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Para realizar este procedimiento utilice las siguientes líneas de código que le permitirán calcular las predicciones con el modelo y también asignar las predicciones correctas.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v("y_pred_NB = NB.predict(X_test)")]),e("p",{staticClass:"t-aw mb-0"},[a._v("y_correctas_NB = y_test")])])])]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[a._v("Como se aprecia, la primera línea corresponde a las predicciones con el modelo entrenado usando el algoritmo "),e("em",[a._v("Naive Bayes")]),a._v(", pasándole como entradas los datos de prueba que fueron separados, y la segunda línea simplemente le reasignamos a una nueva variable los valores de salida correcto de los datos de prueba.")]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 3. Analizar los errores")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Con los datos de las salidas de las predicciones y las salidas correctas se aplica el método de matriz de confusión, de la siguiente manera.")]),e("p",{staticClass:"mx-4 mb-5",attrs:{"data-aos":"fade-right"}},[e("b",{staticClass:"BGP12"},[a._v("MC = confusion_matrix(y_correctas_NB, y_pred_NB)")])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 4. Graficar resultados")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("Implemente las salidas de manera gráfica para entender mucho mejor los datos resultantes; para ello, utilice los siguientes comandos.")]),e("div",{staticClass:"row px-4 mb-5"},[e("div",{staticClass:"col-auto",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"BG12 p-4"},[e("p",{staticClass:"t-aw mb-0"},[a._v("f, ax = plt.subplots(figsize =(5,5))")]),e("p",{staticClass:"t-aw mb-0"},[a._v('sns.heatmap(MC,annot = True,linewidths=0.5,linecolor="blue",fmt = ".0f",ax=ax)')]),e("p",{staticClass:"t-aw mb-0"},[a._v('plt.xlabel("y_pred_NB")')]),e("p",{staticClass:"t-aw mb-0"},[a._v('plt.ylabel("y_correctas_NB")')]),e("p",{staticClass:"t-aw mb-0"},[a._v("plt.show()")])])])]),e("div",{staticClass:"row mb-4",attrs:{"data-aos":"fade-right"}},[e("div",{staticClass:"col-auto"},[e("div",{staticClass:"BGT09 px-4 py-2"},[e("div",{staticClass:"h5 mb-0"},[a._v("Paso 5. Analizar gráfico")])])])]),e("p",{staticClass:"mx-4",attrs:{"data-aos":"fade-right"}},[a._v("El resultado que arroja la técnica de matriz de confusión se puede observar en la siguiente gráfica, en la cual existe un equilibrio ya que la veces en las que predijo correos normales como maliciosos es de 10 y en las que predijo correos maliciosos como maliciosos como normales fue de 8.")]),e("div",{staticClass:"row justify-content-center mb-5"},[e("div",{staticClass:"col-lg-4 col-8 px-lg-0 px-4"},[e("figure",{staticClass:"mb-4",attrs:{"data-aos":"zoom-in"}},[e("img",{attrs:{src:t("1f77"),alt:"Imagen decorativa"}})]),e("p",{staticClass:"mb-0"},[a._v("Matriz de confusión")])])])])])}],r={name:"Tema6",data:function(){return{}},mounted:function(){var a=this;this.$nextTick((function(){a.$aosRefresh()}))},updated:function(){this.$aosRefresh()}},o=r,l=t("2877"),c=Object(l["a"])(o,e,i,!1,null,null,null);s["default"]=c.exports},9970:function(a,s,t){a.exports=t.p+"img/img17.7bd85471.jpg"},"9f5a":function(a,s,t){a.exports=t.p+"img/img01.ec13543f.png"},a8c7:function(a,s,t){a.exports=t.p+"img/img03.d9355467.jpg"},aaf7:function(a,s,t){a.exports=t.p+"img/img13.88087cdd.jpg"},ac67:function(a,s,t){a.exports=t.p+"img/img16.8cd06299.jpg"},becd:function(a,s,t){a.exports=t.p+"img/img15.963bd00a.png"},c090:function(a,s,t){a.exports=t.p+"img/img12.3aabeed8.png"},cdfc:function(a,s,t){a.exports=t.p+"img/img10.fb386987.svg"},ef64:function(a,s,t){a.exports=t.p+"img/img08.63a5dae2.svg"},fdc8:function(a,s,t){a.exports=t.p+"img/img04.e51390ab.jpg"},fdea:function(a,s,t){a.exports=t.p+"img/img09.0cdf8d40.svg"}}]);
//# sourceMappingURL=tema6.0bfdf174.js.map